# HKSC 电商微服务平台项目概览

## 🎯 项目定位

**这是一个 Java 后端开发简历项目，必须符合企业标准化要求**

### 项目重点
- **岗位目标**：Java 后端开发工程师
- **核心技术栈**：Spring Cloud 微服务、分布式系统（未实现，打基础）、高并发秒杀
- **面试亮点**：微服务架构设计、Redis 缓存优化、RabbitMQ 异步解耦、Elasticsearch 搜索引擎

### AI 协作规范

1. **诊断问题时**：如需日志、截图、控制台输出、堆栈信息等，请明确提出需求，不要假设或猜测
2. **文档管理**：除 `.claude` 文件外，可以创建必要的技术文档（如架构设计、接口文档等）
3. **代码质量标准**（后端优先）：
   - 符合阿里巴巴 Java 开发规范
   - RESTful API 设计规范
   - 统一异常处理和日志记录
   - 事务管理和幂等性保证
   - 安全性优先（JWT、密码加密、防 SQL 注入）
   - 高并发场景优化（Redis 分布式锁、Lua 脚本、消息队列）

### 面试题整理规范

**目标**：基于 HKSC 项目生成面试题答案文档

**整理原则**：
1. **结合项目代码**：如果项目中有相关实现，以实际代码为例展开讲解（包含文件路径、代码片段）
2. **标注待实现技术**：如果项目中未实现，记录为"待实现技术"（包括：技术名称 + 应用场景 + 建议加入的模块）
3. **去重处理**：面试题目录中的重复问题只回答一次，合并相似问题
4. **面试导向**：答案需要体现企业级标准，突出项目亮点，适合面试时讲述

**文档存放位置**：`C:\Users\19005\Desktop\markdown\项目\hksc\`
- spring.md - Spring 框架相关面试题
- redis.md - Redis 缓存相关面试题
- 其他技术栈...

## 项目简介

HKSC 是一个基于 Spring Cloud 的电商微服务平台，采用前后端分离架构，支持商品管理、购物车、订单处理和秒杀等核心电商功能。

## 技术栈

### 后端

- **语言**: Java 21
- **框架**: Spring Boot 3.2.5 + Spring Cloud 2023.0.1 + Spring Cloud Alibaba 2023.0.1.0
- **服务治理**: Nacos 2.2.3 (服务发现 + 配置中心)、Sentinel (熔断降级)
- **API 网关**: Spring Cloud Gateway
- **RPC**: OpenFeign
- **数据库**: MySQL 8.0 + MyBatis Plus 3.5.7
- **缓存**: Redis 7.0 + Redisson 3.24.3 (分布式锁)
- **消息队列**: RabbitMQ 3.12
- **搜索引擎**: Elasticsearch 8.11.1
- **安全**: JWT (JSON Web Token) 0.11.5
- **构建工具**: Maven

### 前端
- **框架**: Vue 3.4.21 + Vite 5.2.0
- **UI 库**: Element Plus 2.7.0
- **状态管理**: Pinia 2.1.7
- **路由**: Vue Router 4.3.0
- **HTTP**: Axios 1.6.8

## 项目结构

### 微服务模块（8个）

1. **hksc-gateway** (端口: 8080)
   - API 网关，统一入口
   - JWT 认证过滤器
   - 请求路由转发

2. **hksc-auth**
   - 认证服务
   - JWT Token 生成与验证

3. **hksc-user**
   - 用户注册、登录、信息管理
   - 数据库: hksc_db.user

4. **hksc-product** (核心服务)
   - 商品分类、商品管理
   - 秒杀活动管理（库存、价格、时间控制）
   - Redis 库存缓存 + Lua 脚本原子操作
   - RabbitMQ 消息发布
   - 数据库: hksc_db.category, hksc_db.product, hksc_db.seckill_sku

5. **hksc-cart**
   - 购物车管理
   - Redis 存储（无数据库）
   - OpenFeign 调用 product 服务
   - RabbitMQ 监听订单消息，自动清空购物车

6. **hksc-order** (核心服务)
   - 订单创建、查询、订单项管理
   - 秒杀订单处理
   - OpenFeign 调用 product 和 cart 服务
   - order_sn 唯一性防重
   - 订单超时自动关闭
   - RabbitMQ 消息驱动
   - 数据库: hksc_order.order_info, hksc_order.order_item, hksc_order.seckill_sku

7. **hksc-search**
   - Elasticsearch 全文搜索
   - 商品信息同步到 ES
   - 远程调用 product 服务

8. **hksc-ai**
   - AI 商品推荐
   - 无数据库，调用 product 服务
   - 外部 AI 接口调用

### 前端应用

**hksc-frontend**
- 用户登录/注册
- 商品列表/详情
- 购物车管理
- 订单确认/提交/详情
- 用户中心

### 公共模块

**hksc-common**
- 共享工具类、DTO、配置
- JWT 工具、Redis 配置、统一响应结果

## 核心配置文件

### Nacos 配置中心
- `config/hksc-common.yaml` - 数据库、Redis、RabbitMQ、Sentinel 公共配置
- `config/hksc-gateway-dev.yaml` - 网关路由规则配置
- `config/hksc-{service}-dev.yaml` - 各服务特定配置

### 数据库脚本
- `config/hksc_order.sql` - 订单数据库初始化
- `config/hksc_seckill_schema_v1.sql` - 秒杀库存表
- `config/seckill_sku.sql` - 秒杀 SKU 配置
- `config/ai_studio_code.sql` - AI 模块脚本
- `config/nacos-mysql.sql` - Nacos 配置中心数据库

### Docker 部署
- `docker/docker-compose.yml` - 完整微服务栈定义
  - Nacos (8848/9848/9849)
  - MySQL 8.0 (3307)
  - Redis 7.0 (6379)
  - RabbitMQ (5672/15672)
  - Elasticsearch (9200/9300)
  - Kibana (5601)

## 核心业务流程

### 秒杀流程（重点功能）
1. 秒杀商品配置 → product 服务
2. 库存预热到 Redis（原子操作）
3. 用户下单 → order 服务
4. 库存扣减（Lua 脚本 + 分布式锁）
5. 订单创建（order_sn 防重）
6. 发送 RabbitMQ 消息
7. cart 服务监听消息清空购物车

### 订单流程
1. 用户提交订单 → 网关 → order 服务
2. 远程调用 product（库存校验）
3. 远程调用 cart（获取购物车数据）
4. 创建 order_info + order_item
5. 发送 RabbitMQ 消息
6. 订单超时监听自动关闭

### API 网关路由
```
/api/auth/**    → hksc-auth
/api/user/**    → hksc-user
/api/product/** → hksc-product
/api/order/**   → hksc-order
/api/cart/**    → hksc-cart
/api/search/**  → hksc-search
/api/ai/**      → hksc-ai
```

## 数据库架构

### hksc_db (主业务库)
- `user` - 用户表
- `category` - 商品分类
- `product` - 商品主表
- `seckill_sku` - 秒杀商品表

### hksc_order (订单库)
- `order_info` - 订单主表（order_sn 防重）
- `order_item` - 订单明细
- `seckill_sku` - 秒杀库存副本（本地扣减）

### 其他数据库
- `nacos_config` - Nacos 配置中心存储
- Elasticsearch - 搜索引擎存储

## 关键特性

- **微服务架构**: 8 个独立微服务 + API 网关
- **高可用设计**: Nacos 服务发现、Sentinel 熔断、Redis 分布式锁
- **异步处理**: RabbitMQ 消息驱动，解耦服务依赖
- **全文搜索**: Elasticsearch 支持高效商品搜索
- **秒杀支持**: Redis + Lua 脚本 + 分布式锁实现高并发秒杀
- **安全认证**: JWT Token + 网关认证过滤
- **容器化部署**: Docker Compose 一键启动完整环境
- **逻辑删除**: 数据库配置逻辑删除字段（deleted）
- **防止重复下单**: order_sn 唯一约束

## 启动顺序

1. 启动基础设施（Docker）:
   ```bash
   cd docker
   docker-compose up -d
   ```

2. 等待 Nacos 启动（http://localhost:8848）

3. 导入配置文件到 Nacos:
   - 命名空间: dev
   - 导入 config/ 目录下的 yaml 文件

4. 执行数据库脚本:
   - 连接 MySQL (localhost:3307)
   - 执行 config/ 目录下的 sql 文件

5. 启动后端服务（推荐顺序）:
   - hksc-gateway
   - hksc-auth
   - hksc-user
   - hksc-product
   - hksc-cart
   - hksc-order
   - hksc-search
   - hksc-ai

6. 启动前端:
   ```bash
   cd hksc-frontend
   npm install
   npm run dev
   ```

## 开发环境

- JDK 21
- Maven 3.x
- Node.js 16+
- Docker & Docker Compose

## 项目特点

这是一个生产级别的电商微服务平台，适用于：
- 学习微服务架构
- 电商平台开发
- 秒杀系统设计
- 分布式系统实践

## 关键依赖版本

| 组件 | 版本 |
|------|------|
| Java | 21 |
| Spring Boot | 3.2.5 |
| Spring Cloud | 2023.0.1 |
| Spring Cloud Alibaba | 2023.0.1.0 |
| Nacos | 2.2.3 |
| MyBatis Plus | 3.5.7 |
| Redis | 7.0 |
| RabbitMQ | 3.12 |
| Elasticsearch | 8.11.1 |
| Vue | 3.4.21 |
| Element Plus | 2.7.0 |
